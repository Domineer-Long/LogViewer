<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
<!-- <script type="text/javascript" src="jquery.1.9.1.js"></script> -->
<script type="text/javascript">
	function fileSelected() {
		var file = document.getElementById('file').files[0];
		if (file) {
			var fileSize = 0;
			if (file.size > 1024 * 1024)
				fileSize = ((file.size * 100 / (1024 * 1024)).toFixed(2) / 100)
						.toString()
						+ 'MB';
			else
				fileSize = (Math.round(file.size * 100 / 1024) / 100)
						.toString()
						+ 'KB';

			document.getElementById('fileName').innerHTML = 'Name: '
					+ file.name;
			document.getElementById('fileSize').innerHTML = 'Size: ' + fileSize;
			document.getElementById('fileType').innerHTML = 'Type: '
					+ file.type;
		}
	}

	function uploadFile() {
		var fd = new FormData();
		var file = document.getElementById("file");
		fd.append("file", file.files[0]);
		var xhr = new XMLHttpRequest();
		xhr.upload.addEventListener("progress", uploadProgress, false);
		xhr.addEventListener("load", uploadComplete, false);
		xhr.addEventListener("error", uploadFailed, false);
		xhr.addEventListener("abort", uploadCanceled, false);
		xhr
				.open("POST",
						"http://test.savenumber.com/node/file/public/zsdnq/testfile.do");
		xhr.send(fd);
	}
	function uploadProgress(evt) {
		if (evt.lengthComputable) {
			var percentComplete = (evt.loaded * 100 / evt.total).toFixed(2);
			var percent = percentComplete.toString() + '%';
			document.getElementById('progressBar').style.width = percent;
			document.getElementById('progressNumber').innerHTML = percent;
		} else {
			document.getElementById('progressNumber').innerHTML = 'unable to compute';
		}
	}

	function uploadComplete(evt) {
		/* This event is raised when the server send back a response */
		document.getElementById('progressNumber').innerHTML = "100.00%   &nbsp;&nbsp;&nbsp;上传完成！"
	}

	function uploadFailed(evt) {
		alert("There was an error attempting to upload the file.");
	}

	function uploadCanceled(evt) {
		alert("The upload has been canceled by the user or the browser dropped the connection.");
	}

	function bytes() {
		var bytes = new Uint8Array(10);
		bytes[0] = '1111';
		bytes[1] = 2;
		var xhr = new XMLHttpRequest();
		//          xhr.upload.addEventListener("progress", uploadProgress, false);
		//          xhr.addEventListener("load", uploadComplete, false);
		//          xhr.addEventListener("error", uploadFailed, false);
		//          xhr.addEventListener("abort", uploadCanceled, false);
		xhr.withCredentials = true;
		xhr.open("PUT",
						"http://localhost/sgt-node/file/public/zsdnq/testfile.do");
		xhr.setRequestHeader("content-type", "application/bytes");
		xhr.send(bytes);
	}
</script>
</head>
<body>
	<div class="row">
		<label for="file"> Upload File:</label> <input type="file" name="file"
			id="file" multiple="multiple" onchange="fileSelected();" />
	</div>

	<div id="fileName"></div>
	<div id="fileSize"></div>
	<div id="fileType"></div>
	<div class="row">
		<input type="button" onclick="uploadFile()" value="Upload File" />
	</div>
	<div id="progressNumber"></div>
	<div style="width: 200px; height: 20px;">
		<div id="progressBar"
			style="background: -webkit-gradient(linear, 0 0, 0 100%, from(rgb(107, 252, 102)), to(rgb(29, 92, 34))); height: 100%; width: 0px;"></div>
	</div>
	<input type="button" value="bytes" onclick="bytes()" />
</body>
</html>